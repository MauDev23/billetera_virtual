<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Depositar</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { padding: 40px 20px; background-color: #f4f7f6; }
        .container { max-width: 400px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div class="container">
    <h2 class="text-center mb-4">Depositar</h2>
    
    <p class="text-center">Saldo Actual: <strong>$<span id="currentBalance">0</span></strong></p>

    <div id="alert-container"></div>

    <form id="depositForm">
        <div class="form-group">
            <label>Monto a depositar:</label>
            <input type="number" class="form-control" id="monto" min="1" required>
        </div>
        <button type="submit" class="btn btn-success btn-block">Realizar depósito</button>
    </form>

    <div id="deposito-info" class="mt-3 text-center font-weight-bold text-success"></div>

    <a href="menu.html" class="btn btn-outline-secondary btn-block mt-3">Volver</a>
</div>

<script>
    $(document).ready(function() {
        // 1. Mostrar saldo al cargar
        var saldoActual = parseFloat(localStorage.getItem('walletSaldo')) || 0;
        $('#currentBalance').text(saldoActual);

        // 2. Manejo del Submit
        $('#depositForm').submit(function(e) {
            e.preventDefault();

            var monto = parseFloat($('#monto').val());
            var nuevoSaldo = saldoActual + monto;

            // Guardar en LocalStorage
            localStorage.setItem('walletSaldo', nuevoSaldo);
            
            // Guardar Movimiento
            var historial = JSON.parse(localStorage.getItem('walletMovimientos')) || [];
            historial.push({ tipo: "Depósito", monto: monto, fecha: new Date().toLocaleDateString() });
            localStorage.setItem('walletMovimientos', JSON.stringify(historial));

            // 3. Agregar Leyenda del monto
            $('#deposito-info').text("Monto depositado: $" + monto).hide().fadeIn();

            // 4. Crear Alerta Bootstrap
            var alerta = '<div class="alert alert-success mt-3">✅ Depósito realizado con éxito. Nuevo saldo: $'+ nuevoSaldo +'</div>';
            $('#alert-container').html(alerta);

            // 5. Redirigir tras 2 segundos
            setTimeout(function() {
                window.location.href = 'menu.html';
            }, 2000);
        });
    });
</script>
</body>
</html>